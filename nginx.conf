# Stream block for TCP traffic
stream {
    # Define an upstream block for RabbitMQ
    upstream rabbitmq_backend {
        server 127.0.0.1:5672;  # RabbitMQ running internally
    }

    # Proxy only AMQP traffic
    server {
        listen 5672;  # NGINX listens on 5672
        proxy_pass rabbitmq_backend;

        # Optional: Log traffic for debugging
        access_log /var/log/nginx/rabbitmq_access.log;
        error_log /var/log/nginx/rabbitmq_error.log;
    }
}
